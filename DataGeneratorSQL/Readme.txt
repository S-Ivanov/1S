Программа записи тестовых данных в Microsoft SQL Server.

Пример загрузки данных в 1С с использованием внешнего источника данных:

Соединение = Новый ПараметрыСоединенияВнешнегоИсточникаДанных;
Соединение.СтрокаСоединения = "DRIVER={SQL Server};SERVER=S_Server;UID=User;PWD=Password;
    |DATABASE=S_DATABASE;LANGUAGE=русский";
Соединение.ИмяПользователя = "User";
Соединение.Пароль = "Password";    
ВнешниеИсточникиДанных.СерверБД.УстановитьОбщиеПараметрыСоединения(Соединение);
ВнешниеИсточникиДанных.СерверБД.УстановитьСоединение();

Запрос = Новый Запрос(
    "ВЫБРАТЬ dbo_Компании.Код, dbo_Компании.Наименование
    |ИЗ ВнешнийИсточникДанных.СерверБД.Таблица. dbo_Компании КАК dbo_Компании");
Выборка = Запрос.Выполнить().Выбрать(); 
Пока Выборка.Следующий() Цикл
    НоваяКомпания = Справочники.Компании.СоздатьЭлемент();
    НоваяКомпания.Код = Выборка.Код;
    НоваяКомпания.Наименование = Выборка.Наименование;
    НоваяКомпания.Записать();
КонецЦикла;

ПоследнийКодКомпании = 0;
РодительскаяЗаписьКомпании = Неопределено;
Запрос = Новый Запрос(
    "ВЫБРАТЬ dbo_Продукция.Код, dbo_Продукция.Наименование, dbo_Продукция.КодКомпании
    |ИЗ ВнешнийИсточникДанных.СерверБД.Таблица. dbo_Продукция КАК dbo_Продукция
    |УПОРЯДОЧИТЬ ПО dbo_Продукция.КодКомпании");
Выборка = Запрос.Выполнить().Выбрать(); 
Пока Выборка.Следующий() Цикл
    Если Выборка.КодКомпании <> ПоследнийКодКомпании Тогда
        ПоследнийКодКомпании = Выборка.КодКомпании;
        РодительскаяЗаписьКомпании = Справочники.Компании.НайтиПоКоду(ПоследнийКодКомпании);
    КонецЕсли;
    Если РодительскаяЗаписьКомпании <> Неопределено Тогда
        НоваяПродукция = Справочники.Продукция.СоздатьЭлемент();
        НоваяПродукция.Код = Выборка.Код;
        НоваяПродукция.Наименование = Выборка.Наименование;
        НоваяПродукция.Компания = РодительскаяЗаписьКомпании.Ссылка;
        НоваяПродукция.Записать();
    КонецЕсли;
КонецЦикла;

Пример загрузки данных в 1С с использованием ADO:

СтрокаСоединения = 
    "Provider=SQLNCLI11;Server=.\sqlexpress;Database=Test1S;Uid=myUsername;Pwd=myPassword;";

con = Новый COMОбъект("ADODB.Connection");
con.Open(СтрокаСоединения);

cmd = Новый COMОбъект("ADODB.Command");
cmd.ActiveConnection = con;
cmd.CommandType = 1; // adCmdText

rs = Новый ComОбъект("ADODB.RecordSet");
rs.CursorType = 0; // adOpenForwardOnly
rs.LockType = 1; // adLockReadOnly

cmd.CommandText = "select * from Компании";
rs = cmd.Execute();
Пока rs.EOF() = 0 Цикл
    НоваяКомпания = Справочники.Компании.СоздатьЭлемент();
    НоваяКомпания.Код = rs.Fields("Код").Value;
    НоваяКомпания.Наименование = rs.Fields("Наименование").Value;
    НоваяКомпания.Записать();
    rs.MoveNext();
КонецЦикла;
rs.Close();

ПоследнийКодКомпании = 0;
РодительскаяЗаписьКомпании = Неопределено;
cmd.CommandText = "select * from Продукция order by КодКомпании";
rs = cmd.Execute();
Пока rs.EOF() = 0 Цикл
    Если rs.Fields("КодКомпании").Value <> ПоследнийКодКомпании Тогда
        ПоследнийКодКомпании = rs.Fields("КодКомпании").Value;
        РодительскаяЗаписьКомпании = Справочники.Компании.НайтиПоКоду(ПоследнийКодКомпании);
    КонецЕсли;
    Если РодительскаяЗаписьКомпании <> Неопределено Тогда
        НоваяПродукция = Справочники.Продукция.СоздатьЭлемент();
        НоваяПродукция.Код = rs.Fields("Код").Value;
        НоваяПродукция.Наименование = rs.Fields("Наименование").Value;
        НоваяПродукция.Компания = РодительскаяЗаписьКомпании.Ссылка;
        НоваяПродукция.Записать();
    КонецЕсли;
    rs.MoveNext();
КонецЦикла;
rs.Close();

con.Close();
